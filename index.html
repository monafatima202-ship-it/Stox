<!DOCTYPE html>
<html>
<head>
<title>APX DASHBOARD</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
 background:#020617;
 font-family:Arial;
 color:white;
 padding:20px;
}
.card{
 background:#0f172a;
 padding:20px;
 border-radius:15px;
 margin-bottom:20px;
}
button{
 padding:12px;
 margin:5px;
 border:none;
 border-radius:8px;
 font-weight:bold;
 cursor:pointer;
}
.green{background:#22c55e;}
.red{background:#ef4444;}
.blue{background:#3b82f6;}
input{
 width:95%;
 padding:10px;
 margin:5px;
 border-radius:8px;
 border:none;
}
.hidden{display:none;}
</style>

</head>

<body>

<!-- LOGIN -->
<div id="loginBox" class="card">
<h2>LOGIN</h2>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button class="blue" onclick="login()">LOGIN</button>
</div>

<!-- DASH -->
<div id="dash" class="hidden">

<div class="card">
<h2>BOT CONTROL</h2>
<button class="green" onclick="botOn()">BOT ON</button>
<button class="red" onclick="botOff()">BOT OFF</button>
<button class="green" onclick="sigOn()">SIGNAL ON</button>
<button class="red" onclick="sigOff()">SIGNAL OFF</button>
<div id="status"></div>
</div>

</div>

<script>

const API="https://b.mkapi009.workers.dev";

async function login(){

 try{

  let u=document.getElementById("user").value;
  let p=document.getElementById("pass").value;

  let r=await fetch(API+"/api/login",{
   method:"POST",
   headers:{ "Content-Type":"application/json" },
   body:JSON.stringify({u:u,p:p})
  });

  let j=await r.json();

  if(j.ok){
   document.getElementById("loginBox").style.display="none";
   document.getElementById("dash").classList.remove("hidden");
   loadStatus();
  }else{
   alert("Wrong Login");
  }

 }catch(e){
  alert("API Error");
 }

}

async function botOn(){ await fetch(API+"/api/bot-on"); loadStatus(); }
async function botOff(){ await fetch(API+"/api/bot-off"); loadStatus(); }
async function sigOn(){ await fetch(API+"/api/signal-on"); loadStatus(); }
async function sigOff(){ await fetch(API+"/api/signal-off"); loadStatus(); }

async function loadStatus(){
 let r=await fetch(API+"/api/status");
 let j=await r.json();
 document.getElementById("status").innerHTML =
 "BOT: "+j.bot_enabled+" | SIGNAL: "+j.signal_enabled;
}

</script>

</body>
</html>
