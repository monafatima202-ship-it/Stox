<!DOCTYPE html>
<html>
<head>
<title>APX NEON PRO TERMINAL</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>

body{
 background:#020617;
 color:white;
 font-family:Segoe UI;
 padding:15px;
}

.header{
 text-align:center;
 font-size:26px;
 color:#38bdf8;
 text-shadow:0 0 10px #38bdf8;
 margin-bottom:10px;
}

.card{
 border:1px solid #38bdf8;
 border-radius:14px;
 padding:14px;
 margin-bottom:14px;
 box-shadow:0 0 10px rgba(56,189,248,.4);
}

.btn{
 width:100%;
 padding:12px;
 margin:5px 0;
 border-radius:10px;
 border:1px solid #38bdf8;
 background:#020617;
 color:#38bdf8;
 font-weight:bold;
 box-shadow:0 0 8px #38bdf8;
}

.grid{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:8px;
}

.scroll{
 max-height:240px;
 overflow:auto;
}

.signal{
 border-left:3px solid #38bdf8;
 padding:8px;
 margin:5px 0;
 font-size:14px;
}

.clock{
 text-align:center;
 color:#38bdf8;
 margin-bottom:8px;
}

canvas{
 width:100%;
 height:120px;
 background:#010513;
 border-radius:10px;
 margin-top:8px;
}

.hidden{display:none;}

</style>
</head>

<body>

<div class="header">üöÄ APX NEON PRO</div>
<div class="clock" id="clock"></div>

<!-- LOGIN -->
<div id="loginBox" class="card">
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button class="btn" onclick="login()">LOGIN</button>
</div>

<!-- DASH -->
<div id="dash" class="hidden">

<div class="card">
<div class="grid" id="pairs"></div>
</div>

<div class="card">
<button class="btn" onclick="sendSignal()">üöÄ SEND SIGNAL</button>
<button class="btn" onclick="win()">‚úÖ WIN</button>
<button class="btn" onclick="loss()">‚ùå LOSS</button>
<button class="btn" onclick="mtg()">‚ö† MTG1</button>
</div>

<div class="card">
<div id="summary"></div>
</div>

<div class="card">
üì° SCANNER
<div id="scanner"></div>
</div>

<div class="card">
üìà MINI CHART
<canvas id="chart"></canvas>
</div>

<div class="card scroll">
<div id="feed"></div>
</div>

</div>

<audio id="beep">
<source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg">
</audio>

<script>

const API="https://b.mkapi009.workers.dev";

const PAIRS=[
"AXP-OTC","PFE-OTC","INTL-OTC",
"JNJ-OTC","MCD-OTC","BA-OTC","MSFT-OTC"
];

let selectedPair="";
let lastCount=0;

// LOGIN
async function login(){

 let r=await fetch(API+"/api/login",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({u:user.value,p:pass.value})
 });

 let j=await r.json();

 if(j.ok){
 loginBox.style.display="none";
 dash.classList.remove("hidden");
 buildPairs();
 load();
 }
}

// PAIRS
function buildPairs(){
 let h="";
 PAIRS.forEach(p=>{
 h+=`<button class="btn" onclick="selectedPair='${p}'">${p}</button>`;
 });
 pairs.innerHTML=h;
}

// SEND
async function sendSignal(){
 await fetch(API+"/api/manual-signal",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({pair:selectedPair})
 });
 load();
}

async function win(){ await update("WIN üèÜüíö"); }
async function loss(){ await update("LOSS ‚ùå"); }
async function mtg(){ await update("MTG 1 ‚ö†"); }

async function update(r){
 await fetch(API+"/api/update-result",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({result:r})
 });
 load();
}

// LOAD
async function load(){

 let r=await fetch(API+"/api/signals");
 let j=await r.json();

 let f="";
 let w=0,l=0,m=0,t=0;

 if(j.results.length>lastCount){
 beep.play();
 lastCount=j.results.length;
 }

 let prices=[];

 j.results.forEach(s=>{
 t++;
 if(s.result?.includes("WIN")) w++;
 if(s.result?.includes("LOSS")) l++;
 if(s.result?.includes("MTG")) m++;

 if(s.entry) prices.push(s.entry);

 f+=`<div class="signal">
 ${s.pair} | ${s.direction} | ${s.result}
 </div>`;
 });

 feed.innerHTML=f;

 let acc=t?((w/t)*100).toFixed(1):0;

 summary.innerHTML=`
 Total: ${t} | Win: ${w} | Loss: ${l} | MTG: ${m} | Acc: ${acc}%
 `;

 scanner.innerHTML=PAIRS.map(p=>`üîπ ${p}`).join("<br>");

 drawChart(prices);
}

// SIMPLE CHART
function drawChart(data){

 let c=document.getElementById("chart");
 let ctx=c.getContext("2d");

 ctx.clearRect(0,0,c.width,c.height);

 if(data.length<2) return;

 let max=Math.max(...data);
 let min=Math.min(...data);

 let w=c.width;
 let h=c.height;

 ctx.beginPath();

 data.forEach((v,i)=>{
 let x=(i/(data.length-1))*w;
 let y=h-((v-min)/(max-min))*h;
 if(i===0) ctx.moveTo(x,y);
 else ctx.lineTo(x,y);
 });

 ctx.strokeStyle="#38bdf8";
 ctx.stroke();
}

// CLOCK
setInterval(()=>{
 let d=new Date(Date.now()+5*60*60*1000);
 clock.innerText="UTC+5: "+d.toLocaleString();
},1000);

setInterval(load,6000);

</script>

</body>
</html>
