<!DOCTYPE html>
<html>
<head>
<title>APX ULTRA AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
 background:#020617;
 color:white;
 font-family:Segoe UI;
 padding:20px;
}

.card{
 background:#020617;
 border:1px solid #38bdf8;
 border-radius:12px;
 padding:15px;
 margin-bottom:15px;
}

button{
 padding:12px;
 margin:6px;
 border-radius:10px;
 border:1px solid #38bdf8;
 background:#020617;
 color:#38bdf8;
 cursor:pointer;
 width:100%;
}

input{
 width:100%;
 padding:12px;
 margin:6px 0;
 border-radius:10px;
 border:1px solid #38bdf8;
 background:#020617;
 color:white;
}

.hidden{
 display:none;
}

.signal{
 padding:10px;
 margin:8px;
 border-left:4px solid #38bdf8;
 background:#020617;
}
</style>
</head>

<body>

<h2>ðŸš€ APX ULTRA AI TERMINAL</h2>

<!-- LOGIN -->
<div id="loginBox" class="card">

<input id="userInput" placeholder="Username">
<input id="passInput" type="password" placeholder="Password">

<button onclick="login()">LOGIN</button>

</div>

<!-- DASH -->
<div id="dashBox" class="hidden">

<div class="card">
<button onclick="sendSignal()">SEND SIGNAL</button>
<button onclick="resetFeed()">RESET</button>
</div>

<div class="card">
<button onclick="markWin()">WIN</button>
<button onclick="markLoss()">LOSS</button>
<button onclick="markMTG()">MTG1</button>
</div>

<div class="card">
<button onclick="loadSummary()">VIEW SUMMARY</button>
<div id="summaryBox"></div>
</div>

<div class="card">
<div id="feedBox"></div>
</div>

</div>

<script>

const API="https://b.mkapi009.workers.dev";

function getUser(){
 return document.getElementById("userInput").value;
}

function getPass(){
 return document.getElementById("passInput").value;
}

async function login(){

 let res=await fetch(API+"/api/login",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({
 u:getUser(),
 p:getPass()
 })
 });

 let j=await res.json();

 if(j.ok){
 document.getElementById("loginBox").classList.add("hidden");
 document.getElementById("dashBox").classList.remove("hidden");
 loadFeed();
 }else{
 alert("Login Failed");
 }

}

async function sendSignal(){

 await fetch(API+"/api/manual-signal",{method:"POST"});

 loadFeed();

}

function resetFeed(){
 document.getElementById("feedBox").innerHTML="Reset Done";
}

async function markWin(){ updateResult("WIN ðŸ†"); }
async function markLoss(){ updateResult("LOSS âŒ"); }
async function markMTG(){ updateResult("MTG 1 âš "); }

async function updateResult(r){

 await fetch(API+"/api/update-result",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({result:r})
 });

 loadFeed();

}

async function loadFeed(){

 let res=await fetch(API+"/api/signals");
 let j=await res.json();

 let html="";

 j.results.forEach(s=>{
 html+=`
 <div class="signal">
 ${s.pair} â†’ ${s.direction} â†’ ${s.result}
 </div>
 `;
 });

 document.getElementById("feedBox").innerHTML=html;

}

async function loadSummary(){

 let res=await fetch(API+"/api/signals");
 let j=await res.json();

 let win=0,loss=0,total=0;

 j.results.forEach(s=>{
 total++;
 if(s.result.includes("WIN")) win++;
 if(s.result.includes("LOSS")) loss++;
 });

 let acc=total?((win/total)*100).toFixed(1):0;

 document.getElementById("summaryBox").innerHTML=
 `Total ${total}<br>Win ${win}<br>Loss ${loss}<br>Acc ${acc}%`;

}

setInterval(loadFeed,5000);

</script>

</body>
</html>
