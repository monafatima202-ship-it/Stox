<!DOCTYPE html>
<html>
<head>
<title>APX PREMIUM DASHBOARD</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#020617;color:white;font-family:Segoe UI;padding:20px;}
.card{border:1px solid #38bdf8;padding:15px;border-radius:12px;margin-bottom:15px;}
button{width:100%;padding:12px;margin:6px;border:1px solid #38bdf8;background:#020617;color:#38bdf8;border-radius:10px;}
input{width:100%;padding:12px;margin:6px;border:1px solid #38bdf8;background:#020617;color:white;border-radius:10px;}
.signal{border-left:4px solid #38bdf8;padding:10px;margin:6px;}
.hidden{display:none;}
</style>
</head>

<body>

<h2>ðŸš€ APX PREMIUM TERMINAL</h2>

<div id="loginBox" class="card">
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">LOGIN</button>
</div>

<div id="dash" class="hidden">

<div class="card">
<button onclick="sendSignal()">SEND SIGNAL</button>
<button onclick="resetFeed()">RESET</button>
</div>

<div class="card">
<button onclick="markWin()">WIN</button>
<button onclick="markLoss()">LOSS</button>
<button onclick="markMTG()">MTG1</button>
</div>

<div class="card">
<button onclick="loadSummary()">SUMMARY</button>
<div id="summary"></div>
</div>

<div class="card">
<div id="feed"></div>
</div>

</div>

<script>

const API="https://b.mkapi009.workers.dev";

async function login(){

 let r=await fetch(API+"/api/login",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({
 u:document.getElementById("user").value,
 p:document.getElementById("pass").value
 })
 });

 let j=await r.json();

 if(j.ok){
 loginBox.style.display="none";
 dash.classList.remove("hidden");
 loadFeed();
 }else alert("Login Failed");

}

async function sendSignal(){
 await fetch(API+"/api/manual-signal",{method:"POST"});
 loadFeed();
}

function resetFeed(){
 feed.innerHTML="Reset";
}

async function markWin(){ update("WIN ðŸ†ðŸ’š"); }
async function markLoss(){ update("LOSS âŒ"); }
async function markMTG(){ update("MTG 1 âš "); }

async function update(r){
 await fetch(API+"/api/update-result",{
 method:"POST",
 headers:{ "Content-Type":"application/json" },
 body:JSON.stringify({result:r})
 });
 loadFeed();
}

async function loadFeed(){

 let r=await fetch(API+"/api/signals");
 let j=await r.json();

 let html="";

 j.results.forEach(s=>{
 html+=`<div class="signal">
 ${s.pair} â†’ ${s.direction} â†’ ${s.result}
 </div>`;
 });

 feed.innerHTML=html;

}

async function loadSummary(){

 let r=await fetch(API+"/api/signals");
 let j=await r.json();

 let win=0,loss=0,total=0;

 j.results.forEach(s=>{
 total++;
 if(s.result?.includes("WIN")) win++;
 if(s.result?.includes("LOSS")) loss++;
 });

 let acc=total?((win/total)*100).toFixed(1):0;

 summary.innerHTML=
 `Total ${total}<br>Win ${win}<br>Loss ${loss}<br>Accuracy ${acc}%`;

}

setInterval(loadFeed,5000);

</script>

</body>
</html>
